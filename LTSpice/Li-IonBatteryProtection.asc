Version 4
SHEET 1 1672 680
WIRE 1040 -1728 -160 -1728
WIRE -160 -1632 -160 -1728
WIRE -96 -1632 -160 -1632
WIRE 16 -1632 -32 -1632
WIRE 96 -1632 16 -1632
WIRE 208 -1632 96 -1632
WIRE 352 -1632 208 -1632
WIRE 544 -1632 352 -1632
WIRE 16 -1600 16 -1632
WIRE 96 -1600 96 -1632
WIRE 352 -1600 352 -1632
WIRE 544 -1600 544 -1632
WIRE 96 -1488 96 -1520
WIRE 240 -1488 96 -1488
WIRE 352 -1488 352 -1520
WIRE 352 -1488 320 -1488
WIRE 400 -1488 352 -1488
WIRE 544 -1472 544 -1520
WIRE 576 -1472 544 -1472
WIRE 768 -1472 752 -1472
WIRE 832 -1472 768 -1472
WIRE 896 -1472 832 -1472
WIRE 1040 -1472 1040 -1728
WIRE 1040 -1472 976 -1472
WIRE 208 -1424 208 -1632
WIRE 16 -1408 16 -1520
WIRE 48 -1408 16 -1408
WIRE 176 -1408 48 -1408
WIRE 352 -1392 352 -1488
WIRE 352 -1392 240 -1392
WIRE -160 -1376 -160 -1632
WIRE -160 -1376 -208 -1376
WIRE 96 -1376 96 -1488
WIRE 128 -1376 96 -1376
WIRE 176 -1376 128 -1376
WIRE 544 -1376 480 -1376
WIRE 576 -1376 544 -1376
WIRE 768 -1376 752 -1376
WIRE 800 -1376 768 -1376
WIRE 352 -1360 352 -1392
WIRE 208 -1344 208 -1360
WIRE 240 -1344 240 -1376
WIRE 240 -1344 208 -1344
WIRE -160 -1312 -160 -1376
WIRE 16 -1312 16 -1408
WIRE 96 -1312 96 -1376
WIRE 544 -1296 544 -1376
WIRE 352 -1248 352 -1280
WIRE 480 -1248 352 -1248
WIRE -160 -1168 -160 -1232
WIRE 16 -1168 16 -1248
WIRE 16 -1168 -160 -1168
WIRE 96 -1168 96 -1232
WIRE 96 -1168 16 -1168
WIRE 208 -1168 208 -1344
WIRE 208 -1168 96 -1168
WIRE 544 -1168 544 -1200
WIRE 544 -1168 208 -1168
WIRE -160 -1104 -160 -1168
WIRE -96 -1104 -160 -1104
WIRE 16 -1104 -32 -1104
WIRE 96 -1104 16 -1104
WIRE 208 -1104 96 -1104
WIRE 352 -1104 208 -1104
WIRE 544 -1104 352 -1104
WIRE 16 -1072 16 -1104
WIRE 96 -1072 96 -1104
WIRE 352 -1072 352 -1104
WIRE 544 -1072 544 -1104
WIRE 96 -960 96 -992
WIRE 240 -960 96 -960
WIRE 352 -960 352 -992
WIRE 352 -960 320 -960
WIRE 400 -960 352 -960
WIRE 544 -944 544 -992
WIRE 576 -944 544 -944
WIRE 768 -944 752 -944
WIRE 832 -944 832 -1472
WIRE 832 -944 768 -944
WIRE 208 -896 208 -1104
WIRE 16 -880 16 -992
WIRE 48 -880 16 -880
WIRE 176 -880 48 -880
WIRE 352 -864 352 -960
WIRE 352 -864 240 -864
WIRE -160 -848 -160 -1104
WIRE -160 -848 -208 -848
WIRE 96 -848 96 -960
WIRE 128 -848 96 -848
WIRE 176 -848 128 -848
WIRE 544 -848 480 -848
WIRE 576 -848 544 -848
WIRE 768 -848 752 -848
WIRE 800 -848 800 -1376
WIRE 800 -848 768 -848
WIRE 352 -832 352 -864
WIRE 208 -816 208 -832
WIRE 240 -816 240 -848
WIRE 240 -816 208 -816
WIRE -160 -784 -160 -848
WIRE 16 -784 16 -880
WIRE 96 -784 96 -848
WIRE 544 -768 544 -848
WIRE 352 -720 352 -752
WIRE 480 -720 352 -720
WIRE -160 -640 -160 -704
WIRE 16 -640 16 -720
WIRE 16 -640 -160 -640
WIRE 96 -640 96 -704
WIRE 96 -640 16 -640
WIRE 208 -640 208 -816
WIRE 208 -640 96 -640
WIRE 544 -640 544 -672
WIRE 544 -640 208 -640
WIRE -160 -576 -160 -640
WIRE -96 -576 -160 -576
WIRE 16 -576 -32 -576
WIRE 96 -576 16 -576
WIRE 208 -576 96 -576
WIRE 352 -576 208 -576
WIRE 544 -576 352 -576
WIRE 16 -544 16 -576
WIRE 96 -544 96 -576
WIRE 352 -544 352 -576
WIRE 544 -544 544 -576
WIRE 96 -432 96 -464
WIRE 240 -432 96 -432
WIRE 352 -432 352 -464
WIRE 352 -432 320 -432
WIRE 400 -432 352 -432
WIRE 544 -416 544 -464
WIRE 576 -416 544 -416
WIRE 768 -416 752 -416
WIRE 832 -416 832 -944
WIRE 832 -416 768 -416
WIRE 208 -368 208 -576
WIRE 16 -352 16 -464
WIRE 48 -352 16 -352
WIRE 176 -352 48 -352
WIRE 352 -336 352 -432
WIRE 352 -336 240 -336
WIRE -160 -320 -160 -576
WIRE -160 -320 -208 -320
WIRE 96 -320 96 -432
WIRE 128 -320 96 -320
WIRE 176 -320 128 -320
WIRE 544 -320 480 -320
WIRE 576 -320 544 -320
WIRE 768 -320 752 -320
WIRE 800 -320 800 -848
WIRE 800 -320 768 -320
WIRE 352 -304 352 -336
WIRE 208 -288 208 -304
WIRE 240 -288 240 -320
WIRE 240 -288 208 -288
WIRE -160 -256 -160 -320
WIRE 16 -256 16 -352
WIRE 96 -256 96 -320
WIRE 544 -240 544 -320
WIRE 352 -192 352 -224
WIRE 480 -192 352 -192
WIRE 1040 -128 1040 -1472
WIRE 1088 -128 1040 -128
WIRE 1248 -128 1088 -128
WIRE 1280 -128 1248 -128
WIRE -160 -112 -160 -176
WIRE 16 -112 16 -192
WIRE 16 -112 -160 -112
WIRE 96 -112 96 -176
WIRE 96 -112 16 -112
WIRE 208 -112 208 -288
WIRE 208 -112 96 -112
WIRE 544 -112 544 -144
WIRE 544 -112 208 -112
WIRE -160 -48 -160 -112
WIRE -96 -48 -160 -48
WIRE 16 -48 -32 -48
WIRE 96 -48 16 -48
WIRE 208 -48 96 -48
WIRE 352 -48 208 -48
WIRE 544 -48 352 -48
WIRE 1248 -48 1248 -128
WIRE 16 -16 16 -48
WIRE 96 -16 96 -48
WIRE 352 -16 352 -48
WIRE 544 -16 544 -48
WIRE 1040 -16 1040 -128
WIRE 1088 0 1088 -128
WIRE 96 96 96 64
WIRE 240 96 96 96
WIRE 352 96 352 64
WIRE 352 96 320 96
WIRE 400 96 352 96
WIRE 544 112 544 64
WIRE 576 112 544 112
WIRE 832 112 832 -416
WIRE 832 112 768 112
WIRE 896 112 832 112
WIRE 1248 112 1248 32
WIRE 1248 112 1168 112
WIRE 1280 112 1248 112
WIRE 1168 144 1168 112
WIRE 208 160 208 -48
WIRE 1040 160 1040 64
WIRE 1040 160 976 160
WIRE 16 176 16 64
WIRE 48 176 16 176
WIRE 176 176 48 176
WIRE 352 192 352 96
WIRE 352 192 240 192
WIRE -160 208 -160 -48
WIRE -160 208 -208 208
WIRE 96 208 96 96
WIRE 128 208 96 208
WIRE 176 208 128 208
WIRE 544 208 480 208
WIRE 576 208 544 208
WIRE 800 208 800 -320
WIRE 800 208 768 208
WIRE 352 224 352 192
WIRE 1040 224 1040 160
WIRE 1088 224 1088 64
WIRE 1088 224 1040 224
WIRE 1248 224 1248 112
WIRE 208 240 208 224
WIRE 240 240 240 208
WIRE 240 240 208 240
WIRE -160 272 -160 208
WIRE 16 272 16 176
WIRE 96 272 96 208
WIRE 1040 272 1040 224
WIRE 544 288 544 208
WIRE 832 320 832 112
WIRE 864 320 832 320
WIRE 960 320 960 256
WIRE 960 320 944 320
WIRE 976 320 960 320
WIRE 352 336 352 304
WIRE 480 336 352 336
WIRE 832 336 832 320
WIRE 960 336 960 320
WIRE -160 416 -160 352
WIRE 16 416 16 336
WIRE 16 416 -160 416
WIRE 96 416 96 352
WIRE 96 416 16 416
WIRE 208 416 208 240
WIRE 208 416 96 416
WIRE 544 416 544 384
WIRE 544 416 208 416
WIRE 800 416 800 208
WIRE 800 416 544 416
WIRE 832 416 832 400
WIRE 832 416 800 416
WIRE 960 416 960 400
WIRE 1040 416 1040 368
WIRE 1040 416 960 416
WIRE 1168 416 1168 256
WIRE 1168 416 1040 416
WIRE 1248 416 1248 288
WIRE 1248 416 1168 416
WIRE 208 448 208 416
WIRE 1168 448 1168 416
FLAG 1168 448 0
FLAG -208 208 Sawtooth-1
FLAG 1280 112 Output-V
IOPIN 1280 112 Out
FLAG 1280 -128 Output+V
IOPIN 1280 -128 Out
FLAG 48 176 -Comp-1
FLAG 128 208 +Comp-1
FLAG 896 112 Bias-1
FLAG 480 208 TP-Q1
FLAG 208 448 0
FLAG 400 96 Out-U1
FLAG -208 -320 Sawtooth-2
FLAG 400 -432 Out-U2
FLAG 48 -352 -Comp-2
FLAG 128 -320 +Comp-2
FLAG 480 -320 TP-Q2
FLAG 960 256 Bias-2
FLAG 976 160 Bias-3
FLAG -208 -848 Sawtooth-3
FLAG 400 -960 Out-U3
FLAG 48 -880 -Comp-3
FLAG 128 -848 +Comp-3
FLAG 480 -848 TP-Q3
FLAG -208 -1376 Sawtooth-4
FLAG 400 -1488 Out-U4
FLAG 48 -1408 -Comp-4
FLAG 128 -1376 +Comp-4
FLAG 480 -1376 TP-Q4
SYMBOL res 0 -32 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 80 -32 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res 80 256 R0
SYMATTR InstName R3
SYMATTR Value 620k
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res 336 -32 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL zener 32 336 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName Z1
SYMATTR Value 1N4728
SYMBOL voltage -160 256 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value PULSE(3.6 0 0 1 0 0 1 1)
SYMBOL res 1232 -64 R0
SYMATTR InstName RLoad
SYMATTR Value 2
SYMBOL IRF540 1104 208 R0
WINDOW 0 42 -56 Left 2
WINDOW 3 72 31 Left 2
SYMATTR InstName Q6
SYMATTR Value irf540n
SYMBOL res 336 80 R90
WINDOW 0 1 63 VBottom 2
WINDOW 3 34 46 VTop 2
SYMATTR InstName R5
SYMATTR Value 47k
SYMBOL res 368 320 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 100
SYMBOL cap 1232 224 R0
SYMATTR InstName C4
SYMATTR Value 47µf
SYMBOL res 1056 80 R180
WINDOW 0 28 83 Left 2
WINDOW 3 31 45 Left 2
SYMATTR InstName R9
SYMATTR Value 3.3k
SYMBOL Optos\\PC817C 672 160 R0
SYMATTR InstName U2
SYMBOL npn2 480 288 R0
SYMATTR InstName Q1
SYMATTR Value 2N2222
SYMBOL res 528 -32 R0
SYMATTR InstName R7
SYMATTR Value 120
SYMBOL res 336 -448 R90
WINDOW 0 -1 64 VBottom 2
WINDOW 3 33 47 VTop 2
SYMATTR InstName R15
SYMATTR Value 47k
SYMBOL res 0 -560 R0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 80 -560 R0
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL res 80 -272 R0
SYMATTR InstName R13
SYMATTR Value 620k
SYMBOL res 336 -560 R0
SYMATTR InstName R14
SYMATTR Value 100k
SYMBOL zener 32 -192 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName Z2
SYMATTR Value 1N4728
SYMBOL voltage -160 -272 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value PULSE(3.6 0 0 1 0 0 1 2)
SYMBOL res 368 -208 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R16
SYMATTR Value 100
SYMBOL npn2 480 -240 R0
SYMATTR InstName Q2
SYMATTR Value 2N2222
SYMBOL res 528 -560 R0
SYMATTR InstName R17
SYMATTR Value 120
SYMBOL Optos\\PC817C 672 -368 R0
SYMATTR InstName U4
SYMBOL LM311 208 128 R0
SYMATTR InstName U1
SYMBOL LM311 208 -400 R0
SYMATTR InstName U3
SYMBOL npn2 976 272 R0
SYMATTR InstName Q5
SYMATTR Value 2N2222
SYMBOL res 992 -1488 R90
WINDOW 0 -3 63 VBottom 2
WINDOW 3 31 47 VTop 2
SYMATTR InstName R10
SYMATTR Value 20k
SYMBOL res 960 304 R90
WINDOW 0 1 64 VBottom 2
WINDOW 3 33 46 VTop 2
SYMATTR InstName R8
SYMATTR Value 5.1k
SYMBOL cap 816 336 R0
SYMATTR InstName C1
SYMATTR Value 0.1µf
SYMBOL cap 944 336 R0
SYMATTR InstName C2
SYMATTR Value 0.22µf
SYMBOL cap 1072 0 R0
SYMATTR InstName C3
SYMATTR Value 0.001µf
SYMBOL res 336 -976 R90
WINDOW 0 -1 64 VBottom 2
WINDOW 3 33 47 VTop 2
SYMATTR InstName R18
SYMATTR Value 47k
SYMBOL res 0 -1088 R0
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL res 80 -1088 R0
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL res 80 -800 R0
SYMATTR InstName R21
SYMATTR Value 620k
SYMBOL res 336 -1088 R0
SYMATTR InstName R22
SYMATTR Value 100k
SYMBOL zener 32 -720 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName Z3
SYMATTR Value 1N4728
SYMBOL voltage -160 -800 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value PULSE(3.6 0 0 1 0 0 1 3)
SYMBOL res 368 -736 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R23
SYMATTR Value 100
SYMBOL npn2 480 -768 R0
SYMATTR InstName Q3
SYMATTR Value 2N2222
SYMBOL res 528 -1088 R0
SYMATTR InstName R24
SYMATTR Value 120
SYMBOL Optos\\PC817C 672 -896 R0
SYMATTR InstName U5
SYMBOL LM311 208 -928 R0
SYMATTR InstName U6
SYMBOL res 336 -1504 R90
WINDOW 0 -1 64 VBottom 2
WINDOW 3 33 47 VTop 2
SYMATTR InstName R25
SYMATTR Value 47k
SYMBOL res 0 -1616 R0
SYMATTR InstName R26
SYMATTR Value 10k
SYMBOL res 80 -1616 R0
SYMATTR InstName R27
SYMATTR Value 1k
SYMBOL res 80 -1328 R0
SYMATTR InstName R28
SYMATTR Value 620k
SYMBOL res 336 -1616 R0
SYMATTR InstName R29
SYMATTR Value 100k
SYMBOL zener 32 -1248 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName Z4
SYMATTR Value 1N4728
SYMBOL voltage -160 -1328 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value PULSE(3.6 0 0 1 0 0 1 4)
SYMBOL res 368 -1264 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R30
SYMATTR Value 100
SYMBOL npn2 480 -1296 R0
SYMATTR InstName Q4
SYMATTR Value 2N2222
SYMBOL res 528 -1616 R0
SYMATTR InstName R31
SYMATTR Value 120
SYMBOL Optos\\PC817C 672 -1424 R0
SYMATTR InstName U7
SYMBOL LM311 208 -1456 R0
SYMATTR InstName U8
SYMBOL schottky -96 -1088 R270
WINDOW 0 45 33 VTop 2
WINDOW 3 -13 35 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -96 -560 R270
WINDOW 0 43 33 VTop 2
WINDOW 3 -12 35 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -96 -32 R270
WINDOW 0 40 32 VTop 2
WINDOW 3 -11 34 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -96 -1616 R270
WINDOW 0 43 32 VTop 2
WINDOW 3 -13 34 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
TEXT 1064 -1496 Left 2 !.inc irf540n.sub
TEXT 1064 -1448 Left 2 !.tran 4010m
TEXT 1064 -1480 Left 2 !.inc PC817.sub
TEXT 1064 -1464 Left 2 !.inc LM311.sub
TEXT 872 -1432 Left 2 ;R10 -- 14.4V = 20k, 7.2V = 6.2k
TEXT 864 16 Left 2 ;R9 -- 14.4V = 3.3k, 7.2V = 1.8K
TEXT 728 -1520 Left 2 ;16.6 mA through all optos
TEXT 1056 -1616 Left 6 ;Li-Ion Battery Protector
TEXT 1056 -1584 Left 3 ;Carl J. Nobile
TEXT 1056 -1560 Left 4 ;2017-08-21
